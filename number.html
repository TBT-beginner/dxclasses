<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ•°å­—å½“ã¦ã‚²ãƒ¼ãƒ </title>

  <!-- å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

  <!-- â–¼â–¼â–¼ CSS â–¼â–¼â–¼ -->
  <style>
    /* input[type=number]ã®çŸ¢å°ã‚’éè¡¨ç¤ºã«ã™ã‚‹ï¼ˆè¦‹ãŸç›®ã‚’ã‚¹ãƒƒã‚­ãƒªã•ã›ã‚‹ãŸã‚ï¼‰ */
    input[type=number]::-webkit-inner-spin-button,
    input[type=number]::-webkit-outer-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    input[type=number] {
      -moz-appearance: textfield;
    }

    /* Badgeã®åŸºæœ¬ã‚¹ã‚¿ã‚¤ãƒ« */
    .badge {
        display: inline-block;
        padding: 0.25em 0.6em;
        font-size: 0.875rem; /* text-sm */
        font-weight: 500;
        line-height: 1;
        text-align: center;
        white-space: nowrap;
        vertical-align: baseline;
        border-radius: 0.375rem; /* rounded-md */
    }

    /* Badgeã®ãƒãƒªã‚¢ãƒ³ãƒˆï¼ˆç¨®é¡ï¼‰*/
    .badge-outline {
        border: 1px solid #d1d5db; /* border-gray-300 */
        color: #374151; /* text-gray-700 */
    }
    .badge-destructive {
        background-color: #ef4444; /* bg-red-500 */
        color: #ffffff; /* text-white */
    }
    .badge-secondary {
        background-color: #e5e7eb; /* bg-gray-200 */
        color: #374151; /* text-gray-700 */
    }
    .badge-correct {
        background-color: #2563eb; /* bg-blue-600 */
        color: #ffffff; /* text-white */
    }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-4 flex items-center justify-center">

  <!-- â–¼â–¼â–¼ HTML â–¼â–¼â–¼ -->
  <div class="w-full max-w-md mx-auto shadow-lg bg-white rounded-xl">
    <div class="text-center p-6">
      <h1 class="text-2xl font-bold text-gray-800">ğŸ¯ æ•°å­—å½“ã¦ã‚²ãƒ¼ãƒ </h1>
      <p class="text-gray-500">1ã‹ã‚‰10ã®æ•°å­—ã‚’å½“ã¦ã¦ãã ã•ã„ï¼</p>
    </div>

    <div class="p-6 pt-0 space-y-6">
      <!-- è©¦è¡Œå›æ•° (ã‚²ãƒ¼ãƒ ä¸­ã®ã¿è¡¨ç¤º) -->
      <div id="attempts-container" class="flex justify-center items-center">
        <!-- JSã§Badgeã‚’ç”Ÿæˆ -->
      </div>

      <hr />

      <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
      <div class="text-center p-4 bg-gray-50 rounded-lg">
        <p id="message" class="text-lg font-medium text-gray-700 whitespace-pre-line">1ã‹ã‚‰10ã®æ•°å­—ã‚’å½“ã¦ã¦ãã ã•ã„ï¼</p>
      </div>

      <!-- å…¥åŠ›ã‚¨ãƒªã‚¢ (ã‚²ãƒ¼ãƒ ä¸­ã®ã¿è¡¨ç¤º) -->
      <div id="input-area" class="space-y-4">
        <input
          type="number"
          min="1"
          max="10"
          id="guess-input"
          placeholder="æ•°å­—ã‚’å…¥åŠ›..."
          class="w-full text-center text-lg border-gray-300 rounded-md shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"
        />
        <button id="guess-button" class="w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-md hover:bg-indigo-700 disabled:bg-indigo-300">
          æ¨æ¸¬ã™ã‚‹
        </button>
      </div>

      <!-- å±¥æ­´è¡¨ç¤º -->
      <div id="history-area" class="space-y-2 hidden">
        <p class="text-sm font-medium text-gray-600">æ¨æ¸¬å±¥æ­´:</p>
        <div id="history-list" class="flex flex-wrap gap-2">
          <!-- JSã§Badgeã‚’ç”Ÿæˆ -->
        </div>
      </div>

      <!-- ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ -->
      <div>
        <!-- æ–°ã—ã„ã‚²ãƒ¼ãƒ ãƒœã‚¿ãƒ³ (ã‚²ãƒ¼ãƒ çµ‚äº†å¾Œã®ã¿è¡¨ç¤º) -->
        <button id="reset-button" class="w-full bg-green-500 text-white font-bold py-2 px-4 rounded-md hover:bg-green-600 hidden">
          ğŸ® æ–°ã—ã„ã‚²ãƒ¼ãƒ 
        </button>
      </div>

      <!-- ãƒ«ãƒ¼ãƒ«èª¬æ˜ -->
      <div class="text-xs text-gray-500 space-y-1">
        <p>â€¢ 1ã‹ã‚‰10ã®æ•°å­—ã‚’å½“ã¦ã¦ãã ã•ã„</p>
        <p>â€¢ 3å›ä»¥å†…ã«å½“ã¦ãªã„ã¨ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼</p>
        <p>â€¢ ã‚¨ãƒ³ã‚¿ãƒ¼ã‚­ãƒ¼ã§ã‚‚æ¨æ¸¬ã§ãã¾ã™</p>
      </div>
    </div>
  </div>

  <!-- â–¼â–¼â–¼ JavaScript â–¼â–¼â–¼ -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // --- DOMè¦ç´ ã®å–å¾— ---
      const guessInput = document.getElementById("guess-input");
      const guessButton = document.getElementById("guess-button");
      const resetButton = document.getElementById("reset-button");
      const messageEl = document.getElementById("message");
      const attemptsContainer = document.getElementById("attempts-container");
      const historyArea = document.getElementById("history-area");
      const historyList = document.getElementById("history-list");
      const inputArea = document.getElementById("input-area");

      // --- ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹ã‚’ç®¡ç†ã™ã‚‹å¤‰æ•° ---
      let targetNumber;
      let attempts;
      let gameWon;
      let history;
      const maxAttempts = 3;

      // --- ã‚²ãƒ¼ãƒ ã®åˆæœŸåŒ– ---
      const initializeGame = () => {
        // 1ã‹ã‚‰10ã®ãƒ©ãƒ³ãƒ€ãƒ ãªæ•´æ•°ã‚’ç”Ÿæˆ
        targetNumber = Math.floor(Math.random() * 10) + 1;
        attempts = 0;
        gameWon = false;
        history = [];

        // UIã‚’åˆæœŸçŠ¶æ…‹ã«æ›´æ–°
        messageEl.textContent = "1ã‹ã‚‰10ã®æ•°å­—ã‚’å½“ã¦ã¦ãã ã•ã„ï¼";
        guessInput.value = "";
        guessInput.disabled = false;
        guessButton.disabled = false;
        
        // è¡¨ç¤º/éè¡¨ç¤ºã®åˆ‡ã‚Šæ›¿ãˆ
        inputArea.style.display = "block";
        resetButton.style.display = "none";
        historyArea.style.display = "none";
        historyList.innerHTML = "";
        
        updateAttemptsBadge();
      };

      // --- æ¨æ¸¬ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ ---
      const checkGuess = () => {
        if (gameWon) return;

        const guessNumber = parseInt(guessInput.value, 10);

        // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
        if (isNaN(guessNumber) || guessNumber < 1 || guessNumber > 10) {
          messageEl.textContent = "1ã‹ã‚‰10ã®æ•°å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼";
          return;
        }

        attempts++;
        history.push(guessNumber);
        updateHistory();
        updateAttemptsBadge();

        if (guessNumber === targetNumber) {
          messageEl.innerHTML = `ğŸ‰ æ­£è§£ã§ã™ï¼${attempts}å›ã§å½“ã¦ã¾ã—ãŸï¼<br>ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯ã€Œãƒˆãƒ“ã‚¿ï¼´ã€ã§ã™ã€‚`; // innerHTMLã§æ”¹è¡Œ<br>ã‚’åæ˜ 
          gameWon = true;
          triggerConfetti();
          endGame();
        } else if (attempts >= maxAttempts) {
          messageEl.textContent = `ğŸ˜¢ ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ï¼æ­£è§£ã¯ ${targetNumber} ã§ã—ãŸã€‚`;
          gameWon = true;
          endGame();
        } else if (guessNumber < targetNumber) {
          messageEl.textContent = `ğŸ“ˆ ã‚‚ã£ã¨å¤§ãã„æ•°å­—ã§ã™ï¼ï¼ˆæ®‹ã‚Š${maxAttempts - attempts}å›ï¼‰`;
        } else {
          messageEl.textContent = `ğŸ“‰ ã‚‚ã£ã¨å°ã•ã„æ•°å­—ã§ã™ï¼ï¼ˆæ®‹ã‚Š${maxAttempts - attempts}å›ï¼‰`;
        }

        guessInput.value = "";
        guessInput.focus();
      };

      // --- ã‚²ãƒ¼ãƒ çµ‚äº†æ™‚ã®å‡¦ç† ---
      const endGame = () => {
        guessInput.disabled = true;
        guessButton.disabled = true;
        inputArea.style.display = "none";
        resetButton.style.display = "block";
      };

      // --- UIæ›´æ–°é–¢é€£ã®é–¢æ•° ---
      const updateAttemptsBadge = () => {
        const isGameOver = attempts >= maxAttempts;
        const badgeClass = isGameOver ? "badge badge-destructive" : "badge badge-outline";
        attemptsContainer.innerHTML = `<span class="${badgeClass}">è©¦è¡Œå›æ•°: ${attempts}/${maxAttempts}</span>`;
      };

      const updateHistory = () => {
        historyArea.style.display = "block";
        historyList.innerHTML = ""; // å±¥æ­´ã‚’ã‚¯ãƒªã‚¢
        history.forEach(num => {
          const isCorrect = num === targetNumber;
          const badgeClass = isCorrect ? "badge badge-correct" : "badge badge-secondary";
          historyList.innerHTML += `<span class="${badgeClass}">${num}</span>`;
        });
      };

      // --- ç´™å¹é›ªã‚¨ãƒ•ã‚§ã‚¯ãƒˆ ---
      const triggerConfetti = () => {
        // confetti()é–¢æ•°ã¯CDNã§ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«èª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹
        if (typeof confetti !== 'function') return;

        const duration = 2 * 1000;
        const end = Date.now() + duration;
        const colors = ["#ff0000", "#00ff00", "#0000ff", "#ffff00", "#ff00ff"];

        (function frame() {
          confetti({
            particleCount: 2,
            angle: 60,
            spread: 55,
            origin: { x: 0 },
            colors: colors,
          });
          confetti({
            particleCount: 2,
            angle: 120,
            spread: 55,
            origin: { x: 1 },
            colors: colors,
          });

          if (Date.now() < end) {
            requestAnimationFrame(frame);
          }
        }());
      };
      
      // --- ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š ---
      guessButton.addEventListener("click", checkGuess);
      resetButton.addEventListener("click", initializeGame);
      guessInput.addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          e.preventDefault(); // ãƒ•ã‚©ãƒ¼ãƒ ã®é€ä¿¡ã‚’é˜²ã
          checkGuess();
        }
      });

      // --- ã‚²ãƒ¼ãƒ é–‹å§‹ ---
      initializeGame();
    });
  </script>
</body>
</html>
